<!DOCTYPE html>
<html>
<head>
  <title>Webhook Example</title>
</head>
<body>
  <h1>Webhook Example</h1>
  <div id="output"></div>

  <script>
    function updateOutput(data) {
      const outputDiv = document.getElementById('output');
      const pre = document.createElement('pre');
      pre.textContent = JSON.stringify(data, null, 2);
      outputDiv.appendChild(pre);
    }
  </script>

  <script>
    const http = new XMLHttpRequest();
    http.open('POST', '/webhook');
    http.setRequestHeader('Content-Type', 'application/json');
    http.onreadystatechange = function() {
      if (this.readyState === 4 && this.status === 200) {
        const data = JSON.parse(this.responseText);
        updateOutput(data);
      }
    };
    const requestData = { foo: 'bar' };
    http.send(JSON.stringify(requestData));
  </script>

  <script>
    const http = require('http');

    // Create an HTTP server that listens for incoming requests on port 3000
    const server = http.createServer((req, res) => {
      if (req.method === 'POST' && req.url === '/webhook') {
        let body = '';
        req.on('data', chunk => {
          // Append incoming data chunks to the body variable
          body += chunk.toString();
        });
        req.on('end', () => {
          try {
            // Parse the JSON data in the request body
            const data = JSON.parse(body);
            // Do something with the data, such as saving it to a database or triggering a function
            console.log('Received data:', data);
            // Send a response back to the client
            res.writeHead(200, { 'Content-Type': 'text/plain' });
            res.end('Webhook received');
          } catch (error) {
            // Handle any errors that occur while parsing the request data
            console.error('Error parsing request data:', error);
            res.writeHead(400, { 'Content-Type': 'text/plain' });
            res.end('Error parsing request data');
          }
        });
      } else {
        // Handle requests to other paths or methods
        res.writeHead(404, { 'Content-Type': 'text/plain' });
        res.end('Not found');
      }
    });

    server.listen(3000, () => {
      console.log('Webhook server listening on port 3000');
    });
  </script>
</body>
</html>
